<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RMAN Quest 2: ãƒªã‚«ãƒãƒªã®å®ˆè­·è€…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }
        .code-font {
            font-family: 'Fira Code', monospace;
        }
        .terminal-glow {
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.2);
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <!-- Header -->
    <header class="w-full max-w-2xl mb-6 text-center">
        <h1 class="text-3xl font-bold text-orange-400 mb-2">RMAN Quest 2</h1>
        <p class="text-slate-400">ä¸­ç´šï¼šå¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨è¿…é€Ÿãªãƒªã‚«ãƒãƒª</p>
    </header>

    <!-- Main Game Container -->
    <main id="game-container" class="w-full max-w-2xl bg-slate-800 rounded-xl shadow-2xl overflow-hidden border border-slate-700">
        
        <!-- Status Bar -->
        <div class="bg-slate-900 p-4 border-b border-slate-700 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="text-xs font-bold text-slate-500 uppercase tracking-widest">Progress</span>
                <div class="w-32 h-2 bg-slate-700 rounded-full overflow-hidden">
                    <div id="progress" class="h-full bg-orange-500 progress-bar" style="width: 0%"></div>
                </div>
            </div>
            <div id="stage-display" class="text-sm font-bold text-orange-400">STAGE 1/4</div>
        </div>

        <!-- Terminal / Content Area -->
        <div class="p-6">
            <div id="scenario-area" class="mb-6">
                <h2 id="stage-title" class="text-xl font-bold mb-3 text-white"></h2>
                <div id="scenario-text" class="text-slate-300 leading-relaxed bg-slate-900/50 p-4 rounded-lg border border-slate-700 italic">
                </div>
            </div>

            <div id="terminal" class="bg-black rounded-lg p-4 mb-6 terminal-glow border border-green-900/30 hidden">
                <div class="flex space-x-2 mb-2">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                </div>
                <div id="terminal-content" class="code-font text-green-400 text-sm md:text-base min-h-[100px]">
                </div>
            </div>

            <!-- Quiz / Choices Area -->
            <div id="choices" class="grid grid-cols-1 gap-3">
                <!-- Buttons will be injected here -->
            </div>

            <!-- Feedback Area -->
            <div id="feedback" class="mt-6 p-4 rounded-lg hidden">
            </div>
        </div>

        <!-- Navigation -->
        <div class="p-4 bg-slate-900 flex justify-end">
            <button id="next-btn" class="hidden px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg font-bold transition-colors">
                æ¬¡ã¸é€²ã‚€
            </button>
            <button id="restart-btn" class="hidden px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg font-bold transition-colors">
                æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™
            </button>
        </div>
    </main>

    <!-- Knowledge Base Footer -->
    <footer class="mt-8 w-full max-w-2xl bg-slate-900/50 border border-slate-800 p-4 rounded-lg">
        <h3 class="text-sm font-bold text-slate-500 mb-2 uppercase">DBAã®ãƒ¡ãƒ¢å¸³</h3>
        <p class="text-xs text-slate-400">RMANã®ç¬¬2å¼¾ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å¢—åˆ†ç®¡ç†ã¨ã€éšœå®³ç™ºç”Ÿæ™‚ã®ã€Œãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ æœ€å°åŒ–ã€ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã ã‘ã§ã¯å®ˆã‚Œãªã„å¤§è¦æ¨¡DBã®é‹ç”¨ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚</p>
    </footer>

    <script>
        const stages = [
            {
                id: 1,
                title: "å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®æˆ¦ç•¥",
                scenario: "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒå·¨å¤§åŒ–ã—ã€æ¯æ—¥ã®ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã¦ã„ã¾ã™ã€‚ã¾ãšã¯ã€åŸºç‚¹ã€ã¨ãªã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚Šã€ç¿Œæ—¥ã¯ã€å¤‰æ›´åˆ†ã®ã¿ã€ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹æˆ¦ç•¥ã‚’ç«‹ã¦ã¾ã—ã‚‡ã†ã€‚åŸºç‚¹ã¨ãªã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆãƒ¬ãƒ™ãƒ«0ï¼‰ã®ã‚³ãƒãƒ³ãƒ‰ã¯ï¼Ÿ",
                choices: [
                    { text: "BACKUP DATABASE INCREMENTAL LEVEL 0;", correct: true, feedback: "æ­£è§£ï¼å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è¡Œã†ã«ã¯ã€ã¾ãšLEVEL 0ï¼ˆå®Ÿè³ªãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ãŒå¿…è¦ã§ã™ã€‚ã“ã‚ŒãŒç¿Œæ—¥ä»¥é™ã®æ¯”è¼ƒå¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚" },
                    { text: "BACKUP DATABASE FULL;", correct: false, feedback: "é–“é•ã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã“ã‚Œã§ã¯å¾Œç¶šã®å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆLEVEL 1ï¼‰ã®åŸºç‚¹ã¨ã—ã¦æ˜ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚" },
                    { text: "BACKUP INCREMENTAL LEVEL 1 DATABASE;", correct: false, feedback: "LEVEL 1ã¯å¤‰æ›´åˆ†ã®ã¿ã‚’æŒ‡ã—ã¾ã™ã€‚åŸºç‚¹ã¨ãªã‚‹LEVEL 0ãŒå…ˆã«å¿…è¦ã§ã™ã€‚" }
                ],
                terminal: "RMAN> BACKUP DATABASE INCREMENTAL LEVEL 0;"
            },
            {
                id: 2,
                title: "ç´¯ç©å¢—åˆ† vs å·®åˆ†å¢—åˆ†",
                scenario: "æœˆæ›œã«LEVEL 0ã‚’å–ã‚Šã¾ã—ãŸã€‚ç«æ›œãƒ»æ°´æ›œã¨LEVEL 1ã‚’å–ã‚Šã¾ã™ã€‚æ°´æ›œã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ãŠã„ã¦ã€ã€æœˆæ›œã®LEVEL 0ã‹ã‚‰ã®å…¨ã¦ã®å¤‰æ›´åˆ†ã€ã‚’å«ã‚ãŸã„å ´åˆï¼ˆç´¯ç©å¢—åˆ†ï¼‰ã€ã©ã®å˜èªã‚’è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ",
                choices: [
                    { text: "DIFFERENTIAL", correct: false, feedback: "DIFFERENTIALï¼ˆå·®åˆ†ï¼‰ã¯ã€ç›´è¿‘ã®LEVEL 0ã¾ãŸã¯1ã€ã‹ã‚‰ã®å¤‰æ›´åˆ†ã®ã¿ã‚’å«ã¿ã¾ã™ã€‚å¾©æ—§æ™‚ã®æ‰‹é–“ã¯å¢—ãˆã¾ã™ãŒã‚µã‚¤ã‚ºã¯å°ã•ããªã‚Šã¾ã™ã€‚" },
                    { text: "CUMULATIVE", correct: true, feedback: "æ­£è§£ï¼CUMULATIVEï¼ˆç´¯ç©ï¼‰ã¯ã€ç›´è¿‘ã®LEVEL 0ã€ã‹ã‚‰ã®å…¨ã¦ã®å¤‰æ›´ã‚’å«ã¿ã¾ã™ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚µã‚¤ã‚ºã¯å¤§ãããªã‚Šã¾ã™ãŒã€ãƒªã‚«ãƒãƒªæ™‚ã«é©ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ•°ãŒæ¸›ã‚Šã¾ã™ã€‚" },
                    { text: "COMPLETE", correct: false, feedback: "RMANã«INCREMENTAL COMPLETEã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚" }
                ],
                terminal: "RMAN> BACKUP INCREMENTAL LEVEL 1 CUMULATIVE DATABASE;"
            },
            {
                id: 3,
                title: "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ­ã‚°ã®æƒé™¤",
                scenario: "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ­ã‚°ãŒãƒ‡ã‚£ã‚¹ã‚¯ã‚’åœ§è¿«ã—ã¦ã„ã¾ã™ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã£ãŸå¾Œã«ã€ä¸è¦ã«ãªã£ãŸå¤ã„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã‹ã‚‰è‡ªå‹•çš„ã«å‰Šé™¤ã—ã¦æ•´ç†ã—ãŸã„ã§ã™ã€‚æœ€ã‚‚åŠ¹ç‡çš„ãªã‚³ãƒãƒ³ãƒ‰ã¯ï¼Ÿ",
                choices: [
                    { text: "BACKUP ARCHIVELOG ALL; DELETE ARCHIVELOG;", correct: false, feedback: "2ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã«åˆ†ã‘ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€ä¸€æ‹¬ã§è¡Œã†ã‚ˆã‚Šå®‰å…¨æ€§ãŒä½ããªã‚Šã¾ã™ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¤±æ•—æ™‚ã‚‚æ¶ˆã—ã¦ã—ã¾ã†ãƒªã‚¹ã‚¯ï¼‰ã€‚" },
                    { text: "BACKUP DATABASE PLUS ARCHIVELOG DELETE INPUT;", correct: true, feedback: "å®Œç’§ã§ã™ï¼ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€DBãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å‰å¾Œã«ãƒ­ã‚°ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã€æˆåŠŸã—ãŸåˆ†ã ã‘å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ãã‚Œã‚‹DBAã®ç›¸æ£’ã§ã™ã€‚" },
                    { text: "DELETE OBSOLETE;", correct: false, feedback: "ã“ã‚Œã¯ã€ä¿å­˜æ–¹é‡ï¼ˆRetention Policyï¼‰ã€ã‹ã‚‰å¤–ã‚ŒãŸå¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚»ãƒƒãƒˆã‚’æ¶ˆã™ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚ãƒ­ã‚°ã‚’ç›´æ¥å‡¦ç†ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚" }
                ],
                terminal: "RMAN> BACKUP DATABASE PLUS ARCHIVELOG DELETE INPUT;"
            },
            {
                id: 4,
                title: "ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®éƒ¨åˆ†ãƒªã‚«ãƒãƒª",
                scenario: "ç·Šæ€¥äº‹æ…‹ï¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ« 4ç•ªï¼ˆUSERSè¡¨é ˜åŸŸï¼‰ã ã‘ãŒç‰©ç†å£Šæã—ã¾ã—ãŸã€‚ä»–ã®ãƒ‡ãƒ¼ã‚¿ã¯ç„¡äº‹ãªã®ã§ã€DBå…¨ä½“ã‚’æ­¢ã‚ã‚‹æ™‚é–“ã‚’æœ€å°ã«ã—ãŸã„ã§ã™ã€‚ã¾ãšä½•ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ",
                choices: [
                    { text: "RESTORE DATABASE;", correct: false, feedback: "ã“ã‚Œã§ã¯DBå…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¦ã—ã¾ã„ã¾ã™ã€‚æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã¾ã™ï¼" },
                    { text: "RESTORE DATAFILE 4; RECOVER DATAFILE 4;", correct: true, feedback: "æ­£è§£ï¼ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’æŒ‡å®šã—ã¦RESTOREï¼ˆãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ï¼‰ã¨RECOVERï¼ˆãƒ­ã‚°é©ç”¨ï¼‰ã‚’è¡Œã†ã®ãŒæœ€çŸ­ã®å¾©æ—§ãƒ«ãƒ¼ãƒˆã§ã™ã€‚" },
                    { text: "RECOVER DATABASE;", correct: false, feedback: "RECOVERã®å‰ã«ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æˆ»ã™RESTOREãŒå¿…è¦ã§ã™ã€‚" }
                ],
                terminal: "RMAN> RESTORE DATAFILE 4;\nRMAN> RECOVER DATAFILE 4;"
            }
        ];

        let currentStageIndex = 0;

        const stageTitle = document.getElementById('stage-title');
        const scenarioText = document.getElementById('scenario-text');
        const terminalContent = document.getElementById('terminal-content');
        const terminal = document.getElementById('terminal');
        const choicesArea = document.getElementById('choices');
        const feedbackArea = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const progressBar = document.getElementById('progress');
        const stageDisplay = document.getElementById('stage-display');

        function initStage() {
            const stage = stages[currentStageIndex];
            
            // UI Reset
            stageTitle.innerText = stage.title;
            scenarioText.innerText = stage.scenario;
            terminalContent.innerText = "";
            terminal.classList.add('hidden');
            feedbackArea.classList.add('hidden');
            nextBtn.classList.add('hidden');
            choicesArea.innerHTML = "";
            
            // Progress Update
            const progressPercent = (currentStageIndex / stages.length) * 100;
            progressBar.style.width = `${progressPercent}%`;
            stageDisplay.innerText = `STAGE ${currentStageIndex + 1}/${stages.length}`;

            // Create Choices
            stage.choices.forEach((choice, index) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded-lg transition-all active:scale-[0.98] text-sm md:text-base";
                btn.innerText = choice.text;
                btn.onclick = () => handleChoice(choice);
                choicesArea.appendChild(btn);
            });
        }

        function handleChoice(choice) {
            const stage = stages[currentStageIndex];
            
            // Show Feedback
            feedbackArea.classList.remove('hidden', 'bg-green-900/40', 'bg-red-900/40', 'text-green-200', 'text-red-200');
            if (choice.correct) {
                feedbackArea.classList.add('bg-green-900/40', 'text-green-200');
                feedbackArea.innerHTML = `<span class="font-bold">âœ“ SUCCESS:</span> ${choice.feedback}`;
                
                // Show terminal animation
                terminal.classList.remove('hidden');
                terminalContent.innerText = "> " + stage.terminal;
                
                // Disable choice buttons
                const buttons = choicesArea.querySelectorAll('button');
                buttons.forEach(b => b.disabled = true);
                
                nextBtn.classList.remove('hidden');
            } else {
                feedbackArea.classList.add('bg-red-900/40', 'text-red-200');
                feedbackArea.innerHTML = `<span class="font-bold">âœ— ERROR:</span> ${choice.feedback}`;
            }
        }

        nextBtn.onclick = () => {
            currentStageIndex++;
            if (currentStageIndex < stages.length) {
                initStage();
            } else {
                showEnding();
            }
        };

        function showEnding() {
            progressBar.style.width = `100%`;
            stageTitle.innerText = "ãƒŸãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼";
            scenarioText.innerHTML = `
                <div class="text-center py-4">
                    <p class="text-2xl mb-4 text-orange-400">ğŸ† RMANä¸­ç´š DBA</p>
                    <p class="text-white not-italic mb-4">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚ãªãŸã¯å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ­ã‚°ã®åŠ¹ç‡çš„ãªç®¡ç†ã€ãã—ã¦è¿…é€Ÿãªãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚«ãƒãƒªã®æ‰‹æ³•ã‚’ç¿’å¾—ã—ã¾ã—ãŸã€‚</p>
                    <div class="bg-black/50 p-4 rounded text-left text-xs text-slate-400 font-sans leading-relaxed">
                        <strong>ä»Šå›ã®å¾©ç¿’:</strong><br>
                        ãƒ»Level 0: å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®è¦ªç‰ï¼ˆåŸºç‚¹ï¼‰<br>
                        ãƒ»Level 1 Cumulative: Level 0ã‹ã‚‰ã®å…¨éƒ¨ï¼ˆå®‰å…¨ï¼‰<br>
                        ãƒ»Level 1 Differential: å‰å›ã®Level 0ã‹1ã‹ã‚‰ï¼ˆé«˜é€Ÿï¼‰<br>
                        ãƒ»Plus Archivelog: ãƒ­ã‚°ã‚‚ä¸€ç·’ã«å®ˆã‚‹é­”æ³•ã®è¨€è‘‰<br>
                        ãƒ»Restore/Recover Datafile: å¿…è¦ãªæ‰€ã ã‘ç›´ã™ãƒ—ãƒ­ã®æŠ€
                    </div>
                </div>
            `;
            terminal.classList.add('hidden');
            choicesArea.innerHTML = "";
            feedbackArea.classList.add('hidden');
            nextBtn.classList.add('hidden');
            restartBtn.classList.remove('hidden');
        }

        restartBtn.onclick = () => {
            currentStageIndex = 0;
            restartBtn.classList.add('hidden');
            initStage();
        };

        // Start Game
        window.onload = initStage;
    </script>
</body>
</html>
